<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Global Scrappage Portal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
    }
    header {
      background: #eee;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    nav a {
      margin: 0 10px;
      font-weight: bold;
      text-decoration: none;
      color: black;
      cursor: pointer;
    }
    nav a.active {
      border-bottom: 2px solid blue;
    }
    section {
      display: none;
      padding: 20px;
    }
    section.visible {
      display: block;
    }
    .form-field {
      margin: 10px 0;
    }
    label {
      display: inline-block;
      width: 220px;
    }
    input, select {
      padding: 6px;
      width: 200px;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
    }
    #logo {
      height: 40px;
    }
    #submitMsg {
      margin-top: 10px;
      color: green;
    }
  </style>
</head>
<body>

  <header>
    <img id="logo" src="https://globalscrappageyardsindia.wordpress.com/wp-content/uploads/2024/07/global-1-1.png" alt="Logo" />
    <nav>
      <a class="tab active" onclick="showTab('form')">Form</a>
      <a class="tab" onclick="showTab('download')">Download</a>
      <a class="tab" onclick="passwordPrompt('admin')">Admin</a>
      <a class="tab" onclick="passwordPrompt('edit')">Edit</a>
    </nav>
  </header>

  <section id="form" class="visible">
    <h2>Daily Purchase Entry</h2>

    <div class="form-field">
      <label>Entry Type:</label>
      <select id="entryType" onchange="toggleEntryType()">
        <option value="Vehicle">Vehicle</option>
        <option value="COD">COD</option>
      </select>
    </div>

    <div id="vehicleFields">
      <div class="form-field"><label>Vehicle No.:</label><input id="vehicleNo"></div>
      <div class="form-field"><label>Place of Purchase:</label><input id="place"></div>
      <div class="form-field"><label>Make:</label><input id="make"></div>
      <div class="form-field"><label>Unladen Weight (kg):</label><input id="weight"></div>
      <div class="form-field"><label>Payment to Dealer/RO:</label><input id="paymentDealer"></div>
      <div class="form-field"><label>Payment to Commission:</label><input id="paymentCommission"></div>
      <div class="form-field"><label>Towing Charges:</label><input id="towing"></div>
      <div class="form-field"><label>COD Buyback:</label><input id="codBuyback"></div>
      <div class="form-field"><label>Total:</label><input id="total" readonly></div>
    </div>

    <div id="codFields" style="display:none;">
      <div class="form-field"><label>COD No.:</label><input id="codNo"></div>
      <div class="form-field"><label>COD Purchase Amount:</label><input id="codAmount"></div>
    </div>

    <button onclick="submitEntry()">Submit Entry</button>
    <p id="submitMsg"></p>
  </section>

  <section id="download">
    <h2>Download</h2>
    <p>Coming soon...</p>
  </section>

  <section id="admin">
    <h2>Admin Panel</h2>
    <p>Coming soon...</p>
  </section>

  <section id="edit">
    <h2>Edit Panel</h2>
    <p>Coming soon...</p>
  </section>

  <section id="passwordSection" style="display: none;">
    <h3>Enter Password</h3>
    <input type="password" id="passwordInput" />
    <button onclick="checkPassword()">Submit</button>
    <p id="pwError" style="color:red;"></p>
  </section>

  <script>
    const passwords = {
      admin: "admin456",
      edit: "admin456"
    };
    let targetTab = "";

    function showTab(id) {
      document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
      document.querySelectorAll("section").forEach(s => s.classList.remove("visible"));
      document.querySelector(`.tab[onclick*='${id}']`).classList.add("active");
      document.getElementById(id).classList.add("visible");
    }

    function passwordPrompt(tab) {
      targetTab = tab;
      document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
      document.querySelectorAll("section").forEach(s => s.classList.remove("visible"));
      document.getElementById("passwordSection").style.display = "block";
    }

    function checkPassword() {
      const pw = document.getElementById("passwordInput").value;
      if (pw === passwords[targetTab]) {
        document.getElementById("passwordSection").style.display = "none";
        showTab(targetTab);
        document.getElementById("pwError").innerText = "";
      } else {
        document.getElementById("pwError").innerText = "❌ Invalid password";
      }
    }

    function toggleEntryType() {
      const type = document.getElementById("entryType").value;
      document.getElementById("vehicleFields").style.display = type === "Vehicle" ? "block" : "none";
      document.getElementById("codFields").style.display = type === "COD" ? "block" : "none";
    }

    document.addEventListener("DOMContentLoaded", () => {
      toggleEntryType();
      ["paymentDealer", "paymentCommission", "towing", "codBuyback"].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.addEventListener("input", () => {
            const sum = ["paymentDealer", "paymentCommission", "towing", "codBuyback"]
              .map(id => parseFloat(document.getElementById(id).value) || 0)
              .reduce((a, b) => a + b, 0);
            document.getElementById("total").value = sum;
          });
        }
      });
    });

    function submitEntry() {
      const type = document.getElementById("entryType").value;
      const params = new URLSearchParams({
        entryType: type,
        vehicleNo: document.getElementById("vehicleNo").value,
        place: document.getElementById("place").value,
        make: document.getElementById("make").value,
        weight: document.getElementById("weight").value,
        paymentDealer: document.getElementById("paymentDealer").value,
        paymentCommission: document.getElementById("paymentCommission").value,
        towing: document.getElementById("towing").value,
        codBuyback: document.getElementById("codBuyback").value,
        total: document.getElementById("total").value,
        codNo: document.getElementById("codNo").value,
        codAmount: document.getElementById("codAmount").value
      });

      const scriptURL = "https://script.google.com/macros/s/AKfycbwvpcnumzvkgp03BoYQLXdcczkjDYb6ZxOTCB51pRlJE-3xjSRQfnUhg9amAzYzEktL/exec";
      const fullURL = `${scriptURL}?${params.toString()}`;
      window.open(fullURL, "_blank"); // or use _self if you want to stay on same tab

      document.getElementById("submitMsg").innerText = "✅ Entry submitted!";
    }
  </script>
</body>
</html>
